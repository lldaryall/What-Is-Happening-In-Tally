<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darya Pylypenko - Interactive Portfolio</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            overflow: hidden;
            color: #ffffff;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-canvas {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            border: 2px solid #2779a7;
        }

        /* Loading Screen */
        .loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-text {
            font-size: 2.5rem;
            color: #00d4ff;
            margin-bottom: 2rem;
            text-align: center;
            animation: pulse 2s infinite;
            text-shadow: 0 0 20px #00d4ff;
            font-weight: bold;
        }

        .loading-dots {
            font-size: 1.5rem;
            color: #ffffff;
            animation: blink 1s infinite;
        }

        .loading-progress {
            width: 300px;
            height: 4px;
            background: #333;
            border-radius: 2px;
            margin-top: 2rem;
            overflow: hidden;
        }

        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #ff6b6b);
            width: 0%;
            animation: loading 3s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @keyframes loading {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        /* Intro Screen */
        .intro-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .intro-title {
            font-size: 4rem;
            color: #00d4ff;
            margin-bottom: 1rem;
            text-align: center;
            text-shadow: 0 0 30px #00d4ff;
            font-weight: bold;
        }

        .intro-subtitle {
            font-size: 1.8rem;
            color: #ffffff;
            margin-bottom: 3rem;
            text-align: center;
        }

        .play-button {
            background: linear-gradient(45deg, #00d4ff, #ff6b6b);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.8rem;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        }

        .play-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 35px rgba(0, 212, 255, 0.5);
        }

        /* Menu Button */
        .menu-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #2779a7;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            border-radius: 5px;
            z-index: 100;
            transition: all 0.3s ease;
        }

        .menu-button:hover {
            background: #1e5a7a;
        }

        /* Game UI */
        .game-ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #ffffff;
            font-size: 1rem;
            z-index: 50;
        }

        .instructions {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #ffffff;
            font-size: 0.9rem;
            text-align: center;
            z-index: 50;
        }

        /* Overlay Styles */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }

        .overlay-content {
            background: #2d2d2d;
            padding: 2rem;
            border-radius: 10px;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            border: 2px solid #2779a7;
        }

        .overlay-header {
            color: #2779a7;
            font-size: 2rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .overlay-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #ffffff;
            font-size: 2rem;
            cursor: pointer;
            font-weight: bold;
        }

        .overlay-text {
            color: #ffffff;
            line-height: 1.6;
            font-size: 1rem;
        }

        .project-item {
            background: #1a1a1a;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 5px;
            border-left: 4px solid #2779a7;
        }

        .project-title {
            color: #2779a7;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .skill-item {
            display: inline-block;
            background: #2779a7;
            color: white;
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* Menu Overlay */
        .menu-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 300;
        }

        .menu-content {
            background: #2d2d2d;
            padding: 2rem;
            border-radius: 10px;
            border: 2px solid #2779a7;
            text-align: center;
        }

        .menu-title {
            color: #2779a7;
            font-size: 2rem;
            margin-bottom: 2rem;
        }

        .menu-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .menu-btn {
            background: #2779a7;
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 1rem;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .menu-btn:hover {
            background: #1e5a7a;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Loading Screen -->
        <div class="loading-screen" id="loading-screen">
            <div class="loading-text">Loading Portfolio...</div>
            <div class="loading-dots" id="loading-dots">Preparing interactive experience</div>
            <div class="loading-progress">
                <div class="loading-bar"></div>
            </div>
            <div style="margin-top: 2rem; color: #cccccc; font-size: 0.9rem; cursor: pointer;" id="skip-loading">Click to skip loading</div>
        </div>

        <!-- Intro Screen -->
        <div class="intro-screen" id="intro-screen">
            <h1 class="intro-title">Darya Pylypenko</h1>
            <p class="intro-subtitle">Interactive Portfolio Experience</p>
            <button class="play-button" id="play-button">Enter Portfolio</button>
        </div>

        <!-- Game Canvas -->
        <div id="game-canvas"></div>

        <!-- Menu Button -->
        <button class="menu-button" id="menu-button">Menu</button>

        <!-- Game UI -->
        <div class="game-ui" id="game-ui" style="display: none;">
            <div>Use WASD or Arrow Keys to move</div>
        </div>

        <!-- Instructions -->
        <div class="instructions" id="instructions" style="display: none;">
            <div>Use WASD/Arrow Keys to move • Click to move • SPACE to jump</div>
            <div>Walk to the glowing markers to explore my portfolio sections</div>
            <div>Talk to NPCs for random interactions • Press ESC for menu</div>
        </div>

        <!-- Menu Overlay -->
        <div class="menu-overlay" id="menu-overlay">
            <div class="menu-content">
                <h2 class="menu-title">Portfolio Menu</h2>
                <div class="menu-buttons">
                    <button class="menu-btn" data-section="about">About Me</button>
                    <button class="menu-btn" data-section="projects">Projects</button>
                    <button class="menu-btn" data-section="resume">Resume</button>
                    <button class="menu-btn" data-section="skills">Skills</button>
                    <button class="menu-btn" data-section="awards">Awards</button>
                    <button class="menu-btn" data-section="contact">Contact</button>
                </div>
            </div>
        </div>

        <!-- Portfolio Section Overlays -->
        <!-- About Me Overlay -->
        <div class="overlay" id="about-overlay">
            <div class="overlay-content">
                <button class="overlay-close">&times;</button>
                <h2 class="overlay-header">About Me</h2>
                <div class="overlay-text">
                    <p>Hello! I'm Darya Pylypenko, a passionate developer with expertise in web development, C++ programming, and creating interactive digital experiences.</p>
                    <p>I specialize in full-stack development using modern technologies like JavaScript, React, Node.js, and C++. My journey in technology began with a fascination for how things work, leading me to become a versatile developer who loves creating engaging user experiences and solving complex problems.</p>
                    <p>I have experience working on various projects including web applications, C++ projects, and interactive portfolios. I'm always eager to learn new technologies and contribute to innovative solutions.</p>
                    <p>When I'm not coding, you can find me exploring new technologies, contributing to open-source projects, or working on creative side projects that push the boundaries of what's possible with code.</p>
                    <br>
                    <p><strong>Fun Fact:</strong> I built this interactive portfolio using Phaser 3 to showcase my skills in a unique and engaging way!</p>
                </div>
            </div>
        </div>

        <!-- Projects Overlay -->
        <div class="overlay" id="projects-overlay">
            <div class="overlay-content">
                <button class="overlay-close">&times;</button>
                <h2 class="overlay-header">My Projects</h2>
                <div class="overlay-text">
                    <div class="project-item">
                        <div class="project-title">Interactive Portfolio Website</div>
                        <p>A game-style portfolio built with Phaser 3, featuring a 2D world where visitors can explore different sections by walking around. This project showcases my ability to create engaging user experiences using modern web technologies.</p>
                        <p><strong>Technologies:</strong> Phaser 3, JavaScript, HTML5, CSS3</p>
                    </div>
                    <div class="project-item">
                        <div class="project-title">Coppola Artistica Website</div>
                        <p>A modern web application built with React and modern web technologies. Features responsive design, interactive elements, and optimized performance for showcasing artistic work.</p>
                        <p><strong>Technologies:</strong> React, JavaScript, HTML5, CSS3</p>
                        <p><strong>Live Demo:</strong> <a href="https://coppolaartistica.vercel.app/" target="_blank" style="color: #00d4ff;">coppolaartistica.vercel.app</a></p>
                    </div>
                    <div class="project-item">
                        <div class="project-title">C++ Projects Collection</div>
                        <p>A comprehensive collection of C++ projects demonstrating various programming concepts, algorithms, and data structures. Includes projects ranging from basic programming exercises to complex system implementations.</p>
                        <p><strong>Technologies:</strong> C++, Data Structures, Algorithms</p>
                        <p><strong>GitHub:</strong> <a href="https://github.com/lldaryall/C-projects" target="_blank" style="color: #00d4ff;">github.com/lldaryall/C-projects</a></p>
                    </div>
                    <div class="project-item">
                        <div class="project-title">Web Development Projects</div>
                        <p>Various web applications and websites built using modern frameworks and technologies. Includes responsive designs, interactive features, and optimized user experiences.</p>
                        <p><strong>Technologies:</strong> JavaScript, HTML5, CSS3, React, Node.js</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resume Overlay -->
        <div class="overlay" id="resume-overlay">
            <div class="overlay-content">
                <button class="overlay-close">&times;</button>
                <h2 class="overlay-header">Resume & Experience</h2>
                <div class="overlay-text">
                    <p><strong>Full Stack Developer</strong> - Freelance (2020-Present)</p>
                    <p>Developing web applications and interactive experiences using modern technologies.</p>
                </div>
            </div>
        </div>

        <!-- Skills Overlay -->
        <div class="overlay" id="skills-overlay">
            <div class="overlay-content">
                <button class="overlay-close">&times;</button>
                <h2 class="overlay-header">Skills & Technologies</h2>
                <div class="overlay-text">
                    <span class="skill-item">JavaScript</span>
                    <span class="skill-item">C++</span>
                    <span class="skill-item">React</span>
                    <span class="skill-item">Phaser 3</span>
                    <span class="skill-item">HTML5</span>
                    <span class="skill-item">CSS3</span>
                </div>
            </div>
        </div>

        <!-- Awards Overlay -->
        <div class="overlay" id="awards-overlay">
            <div class="overlay-content">
                <button class="overlay-close">&times;</button>
                <h2 class="overlay-header">Awards & Certifications</h2>
                <div class="overlay-text">
                    <p>Interactive Portfolio Recognition</p>
                    <p>Web Development Projects</p>
                    <p>C++ Programming Excellence</p>
                </div>
            </div>
        </div>

        <!-- Contact Overlay -->
        <div class="overlay" id="contact-overlay">
            <div class="overlay-content">
                <button class="overlay-close">&times;</button>
                <h2 class="overlay-header">Contact Me</h2>
                <div class="overlay-text">
                    <p>I'm always interested in new opportunities and exciting projects!</p>
                    <br>
                    <p><strong>Email:</strong> darya.pylypenko@example.com</p>
                    <p><strong>Location:</strong> Available for remote work</p>
                    <br>
                    <p><strong>Social Media & Links:</strong></p>
                    <p><strong>LinkedIn:</strong> <a href="https://www.linkedin.com/in/darya-pylypenko-24288b207" target="_blank" style="color: #00d4ff;">linkedin.com/in/darya-pylypenko-24288b207</a></p>
                    <p><strong>Website:</strong> <a href="https://daryapylypenko.com/" target="_blank" style="color: #00d4ff;">daryapylypenko.com</a></p>
                    <p><strong>GitHub:</strong> <a href="https://github.com/lldaryall" target="_blank" style="color: #00d4ff;">github.com/lldaryall</a></p>
                    <br>
                    <p><strong>Featured Projects:</strong></p>
                    <p><strong>Coppola Artistica:</strong> <a href="https://coppolaartistica.vercel.app/" target="_blank" style="color: #00d4ff;">coppolaartistica.vercel.app</a></p>
                    <p><strong>C++ Projects:</strong> <a href="https://github.com/lldaryall/C-projects" target="_blank" style="color: #00d4ff;">github.com/lldaryall/C-projects</a></p>
                    <br>
                    <p>Feel free to reach out if you'd like to collaborate or just want to chat about technology!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game variables
        let game;
        let player;
        let cursors;
        let wasd;
        let markers = [];
        let currentOverlay = null;

        // Loading screen animation
        function animateLoading() {
            const dots = document.getElementById('loading-dots');
            const messages = [
                'Preparing interactive experience',
                'Loading game assets',
                'Initializing portfolio world',
                'Setting up animations',
                'Almost ready...'
            ];
            let messageIndex = 0;
            let dotCount = 0;
            
            const interval = setInterval(() => {
                dotCount = (dotCount + 1) % 4;
                dots.textContent = messages[messageIndex] + '.'.repeat(dotCount);
                
                if (dotCount === 0) {
                    messageIndex = (messageIndex + 1) % messages.length;
                }
            }, 800);
            
            // Auto-hide loading screen after 3 seconds
            setTimeout(() => {
                clearInterval(interval);
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('intro-screen').style.display = 'flex';
            }, 3000);
            
            return interval;
        }

        // Game configuration - FIXED VERSION
        const config = {
            type: Phaser.AUTO,
            width: 1000,
            height: 700,
            parent: 'game-canvas',
            backgroundColor: '#2d5016',
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 },
                    debug: false
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            },
            scale: {
                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH
            }
        };

        // Preload assets
        function preload() {
            console.log('Preload function called');
        }

        // Create game world - ENHANCED VERSION
        function create() {
            console.log('Create function called - starting game world creation');
            
            // Create a simple background
            this.add.rectangle(500, 350, 1000, 700, 0x2d5016);
            console.log('Background created');
            
            // Create grass pattern
            for (let x = 0; x < 1000; x += 40) {
                for (let y = 0; y < 700; y += 40) {
                    const grass = this.add.rectangle(x + 20, y + 20, 40, 40, 0x4a7c59);
                    grass.setAlpha(0.8 + Math.random() * 0.2);
                }
            }
            console.log('Grass pattern created');
            
            // Create roads
            this.add.rectangle(500, 100, 1000, 20, 0x666666); // Horizontal road
            this.add.rectangle(500, 600, 1000, 20, 0x666666); // Horizontal road
            this.add.rectangle(100, 350, 20, 700, 0x666666); // Vertical road
            this.add.rectangle(900, 350, 20, 700, 0x666666); // Vertical road
            console.log('Roads created');
            
            // Create buildings
            const buildings = [
                { x: 200, y: 150, width: 80, height: 60, color: 0x8b4513, name: 'Office' },
                { x: 400, y: 150, width: 100, height: 80, color: 0x654321, name: 'Tech Hub' },
                { x: 600, y: 150, width: 90, height: 70, color: 0x8b4513, name: 'Studio' },
                { x: 200, y: 450, width: 120, height: 100, color: 0x654321, name: 'Lab' },
                { x: 500, y: 450, width: 110, height: 90, color: 0x8b4513, name: 'Workshop' },
                { x: 700, y: 450, width: 100, height: 80, color: 0x654321, name: 'Library' }
            ];
            
            buildings.forEach(building => {
                const buildingRect = this.add.rectangle(building.x, building.y, building.width, building.height, building.color);
                // Add building details
                this.add.rectangle(building.x, building.y - 20, building.width - 20, 10, 0x000000); // Roof
                this.add.rectangle(building.x - 30, building.y, 10, building.height, 0x654321); // Door
                // Add building label
                const label = this.add.text(building.x, building.y - 40, building.name, {
                    fontSize: '12px',
                    fill: '#ffffff',
                    fontFamily: 'Courier New',
                    stroke: '#000000',
                    strokeThickness: 1
                });
                label.setOrigin(0.5);
            });
            console.log('Buildings created');
            
            // Create plants and decorations
            for (let i = 0; i < 20; i++) {
                const x = Math.random() * 1000;
                const y = Math.random() * 700;
                if (x > 50 && x < 950 && y > 50 && y < 650) {
                    const plant = this.add.circle(x, y, 8, 0x228b22);
                    this.tweens.add({
                        targets: plant,
                        scaleX: 1.2,
                        scaleY: 1.2,
                        duration: 2000 + Math.random() * 2000,
                        yoyo: true,
                        repeat: -1
                    });
                }
            }
            console.log('Plants created');
            
            // Create NPCs
            const npcs = [
                { x: 300, y: 200, color: 0x4169e1, name: 'Developer' },
                { x: 500, y: 300, color: 0xff6347, name: 'Designer' },
                { x: 700, y: 400, color: 0x32cd32, name: 'Manager' },
                { x: 150, y: 500, color: 0xffd700, name: 'Mentor' }
            ];
            
            npcs.forEach(npc => {
                const npcCircle = this.add.circle(npc.x, npc.y, 15, npc.color);
                const npcLabel = this.add.text(npc.x, npc.y - 25, npc.name, {
                    fontSize: '10px',
                    fill: '#ffffff',
                    fontFamily: 'Courier New',
                    stroke: '#000000',
                    strokeThickness: 1
                });
                npcLabel.setOrigin(0.5);
                
                // Add NPC animation
                this.tweens.add({
                    targets: npcCircle,
                    y: npc.y - 5,
                    duration: 3000 + Math.random() * 2000,
                    yoyo: true,
                    repeat: -1
                });
            });
            console.log('NPCs created');
            
            // Create player - BIG RED CIRCLE (NO PHYSICS)
            player = this.add.circle(100, 100, 25, 0xff0000);
            console.log('Player created at position:', player.x, player.y);
            
            // Add player animation
            this.tweens.add({
                targets: player,
                scaleX: 1.1,
                scaleY: 1.1,
                duration: 1000,
                yoyo: true,
                repeat: -1
            });
            console.log('Player animation added');
            
            // Create interactive markers with proper data
            const markerData = [
                { x: 200, y: 200, color: 0x00ff00, section: 'about', name: 'About Me' },
                { x: 500, y: 300, color: 0x0000ff, section: 'projects', name: 'Projects' },
                { x: 800, y: 500, color: 0xff00ff, section: 'resume', name: 'Resume' },
                { x: 300, y: 500, color: 0xffff00, section: 'skills', name: 'Skills' },
                { x: 700, y: 200, color: 0xff8000, section: 'awards', name: 'Awards' },
                { x: 100, y: 400, color: 0x00ffff, section: 'contact', name: 'Contact' }
            ];
            
            markers = markerData.map(data => {
                const marker = this.add.circle(data.x, data.y, 20, data.color);
                marker.setData('section', data.section);
                marker.setData('name', data.name);
                
                // Add pulsing animation
                this.tweens.add({
                    targets: marker,
                    scaleX: 1.3,
                    scaleY: 1.3,
                    duration: 1500,
                    yoyo: true,
                    repeat: -1
                });
                
                // Add label
                const label = this.add.text(data.x, data.y - 35, data.name, {
                    fontSize: '12px',
                    fill: '#ffffff',
                    fontFamily: 'Courier New',
                    stroke: '#000000',
                    strokeThickness: 2
                });
                label.setOrigin(0.5);
                
                // Add hover effects
                marker.on('pointerover', () => {
                    marker.setTint(0xffffff);
                    label.setStyle({ fill: '#ffff00', stroke: '#000000', strokeThickness: 3 });
                });
                
                marker.on('pointerout', () => {
                    marker.clearTint();
                    label.setStyle({ fill: '#ffffff', stroke: '#000000', strokeThickness: 2 });
                });
                
                return marker;
            });
            console.log('Markers created');
            
            // Set up input
            cursors = this.input.keyboard.createCursorKeys();
            wasd = this.input.keyboard.addKeys('W,S,A,D');
            console.log('Input controls set up');
            
            // Add spacebar to jump
            this.input.keyboard.on('keydown-SPACE', () => {
                if (player) {
                    this.tweens.add({
                        targets: player,
                        y: player.y - 50,
                        duration: 300,
                        yoyo: true,
                        ease: 'Back.easeOut'
                    });
                }
            });
            
            // Add mouse click to move
            this.input.on('pointerdown', (pointer) => {
                if (player) {
                    this.tweens.add({
                        targets: player,
                        x: pointer.x,
                        y: pointer.y,
                        duration: 1000,
                        ease: 'Power2.easeOut'
                    });
                }
            });
            
            console.log('Game world creation completed successfully!');
        }

        // Update game loop
        function update() {
            if (!player) return;
            
            // Player movement
            const speed = 200;
            
            if (cursors.left.isDown || wasd.A.isDown) {
                player.x -= speed * this.game.loop.delta / 1000;
            }
            if (cursors.right.isDown || wasd.D.isDown) {
                player.x += speed * this.game.loop.delta / 1000;
            }
            if (cursors.up.isDown || wasd.W.isDown) {
                player.y -= speed * this.game.loop.delta / 1000;
            }
            if (cursors.down.isDown || wasd.S.isDown) {
                player.y += speed * this.game.loop.delta / 1000;
            }
            
            // Manual boundary checking (replaces setCollideWorldBounds)
            if (player.x < 30) player.x = 30;
            if (player.x > 970) player.x = 970;
            if (player.y < 30) player.y = 30;
            if (player.y > 670) player.y = 670;
            
            // Check for marker interactions
            markers.forEach(marker => {
                const distance = Phaser.Math.Distance.Between(player.x, player.y, marker.x, marker.y);
                if (distance < 50) {
                    // Player is close to marker
                    marker.setTint(0xffffff);
                    marker.setAlpha(0.8);
                    
                    // Auto-trigger interaction if close enough
                    if (distance < 30) {
                        const section = marker.getData('section');
                        if (section && !currentOverlay) {
                            console.log('Auto-triggering interaction with:', section);
                            openOverlay(section);
                        }
                    }
                } else {
                    // Player is far from marker
                    marker.clearTint();
                    marker.setAlpha(1);
                }
            });
            
            // Check for random interactions (buildings, NPCs, etc.)
            if (Math.random() < 0.001) { // 0.1% chance per frame
                const randomMessages = [
                    "You found a hidden easter egg! 🎉",
                    "The wind whispers secrets of code...",
                    "A butterfly lands on your shoulder.",
                    "You hear distant music from the Tech Hub.",
                    "The plants seem to be growing...",
                    "Something sparkles in the distance.",
                    "You feel inspired to code something new!",
                    "The buildings seem to pulse with energy.",
                    "A shooting star crosses the sky above.",
                    "You discover a new programming technique!"
                ];
                
                const randomMessage = randomMessages[Math.floor(Math.random() * randomMessages.length)];
                console.log(randomMessage);
                
                // Show temporary message on screen
                const messageText = this.add.text(player.x, player.y - 50, randomMessage, {
                    fontSize: '14px',
                    fill: '#ffff00',
                    fontFamily: 'Courier New',
                    stroke: '#000000',
                    strokeThickness: 2
                });
                messageText.setOrigin(0.5);
                
                // Fade out message
                this.tweens.add({
                    targets: messageText,
                    alpha: 0,
                    y: messageText.y - 30,
                    duration: 3000,
                    onComplete: () => messageText.destroy()
                });
            }
        }

        // Open overlay for specific section
        function openOverlay(section) {
            const overlay = document.getElementById(section + '-overlay');
            if (overlay) {
                overlay.style.display = 'flex';
                currentOverlay = overlay;
                if (game) {
                    game.scene.pause();
                }
            }
        }

        // Close current overlay
        function closeOverlay() {
            if (currentOverlay) {
                currentOverlay.style.display = 'none';
                currentOverlay = null;
                if (game) {
                    game.scene.resume();
                }
            }
        }

        // Start the game
        function startGame() {
            console.log('Starting game...');
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';
            document.getElementById('instructions').style.display = 'block';
            document.getElementById('menu-button').style.display = 'block';
            
            try {
                game = new Phaser.Game(config);
                console.log('Phaser game created successfully');
            } catch (error) {
                console.error('Error creating Phaser game:', error);
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, starting initialization');
            
            // Start loading animation
            animateLoading();
            
            // Fallback: Force hide loading screen after 5 seconds
            setTimeout(() => {
                if (document.getElementById('loading-screen').style.display !== 'none') {
                    document.getElementById('loading-screen').style.display = 'none';
                    document.getElementById('intro-screen').style.display = 'flex';
                }
            }, 5000);

            // Skip loading button
            document.getElementById('skip-loading').addEventListener('click', function() {
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('intro-screen').style.display = 'flex';
            });
            
            // Play button
            document.getElementById('play-button').addEventListener('click', startGame);

            // Menu button
            document.getElementById('menu-button').addEventListener('click', function() {
                document.getElementById('menu-overlay').style.display = 'flex';
                if (game) {
                    game.scene.pause();
                }
            });
            
            // Menu section buttons
            document.querySelectorAll('.menu-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    document.getElementById('menu-overlay').style.display = 'none';
                    openOverlay(section);
                });
            });
            
            // Close overlay buttons
            document.querySelectorAll('.overlay-close').forEach(btn => {
                btn.addEventListener('click', closeOverlay);
            });
            
            // Close overlays when clicking outside
            document.querySelectorAll('.overlay').forEach(overlay => {
                overlay.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeOverlay();
                    }
                });
            });
            
            // Close menu when clicking outside
            document.getElementById('menu-overlay').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                    if (game) {
                        game.scene.resume();
                    }
                }
            });
            
            console.log('Event listeners set up');
        });
    </script>
</body>
</html>